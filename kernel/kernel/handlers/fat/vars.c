#include <kernel/types.h>
#include <kernel/msg.h>
#include <kernel/proc.h>
#include "fat.h"


struct Device fat_handler;





struct Fat12BPBSpec fat12_bpb[] =
{
   {512, 1, 1, 2,  64,  320, 0xfe, 1,  8, 1},   /* 160K */ 
   {512, 1, 1, 2,  64,  360, 0xfc, 2,  9, 1},   /* 180K */ 
   {512, 2, 1, 2, 112,  640, 0xff, 1,  8, 2},   /* 320K */ 
   {512, 2, 1, 2, 112,  720, 0xfd, 2,  9, 2},   /* 360K */ 
   {512, 2, 1, 2, 112, 1440, 0xf9, 3,  9, 2},   /* 720K */ 
   {512, 1, 1, 2, 224, 2400, 0xf9, 7, 15, 2},   /* 1.2M */ 
   {512, 1, 1, 2, 224, 2880, 0xf0, 9, 18, 2},   /* 1.44M */ 
   {512, 2, 1, 2, 240, 5760, 0xf0, 9, 36, 2}    /* 2.88M */
};


struct FatDskSzToSecPerClus dsksz_to_spc_fat16[] =
{
	{      8400,   0},   /* <= 4.1MB,   Invalid    */
	{     32680,   2},   /* <=  16MB,   1k cluster */
	{    262144,   4},   /* <= 128MB,   2k cluster */
	{    524288,   8},   /* <= 256MB,   4k cluster */
	{   1048576,  16},   /* <= 512MB,   8k cluster */
	{0xffffffff,   0}    /* >  512MB,   Invalid    */
};


struct FatDskSzToSecPerClus dsksz_to_spc_fat32[] =
{
	{     66600,   0},   /* <= 32.5MB,   Invalid      */
	{    532480,   1},   /* <=  260MB,   0.5k cluster */
	{  16777216,   8},   /* <=    8GB,   4k cluster   */
	{  33554432,  16},   /* <=   16GB,   8k cluster   */
	{  67108864,  32},   /* <=   32MB,   16k cluster  */
	{0xffffffff,  64}    /* >    32MB,   32k cluster  */
};


/*
 *
 */

uint8 fat32_bootcode[] = 
{
	0x00, 0x00, 0xb8, 0x00, 0x00, 0x8e, 0xd8, 0x8e,
	0xc0, 0xb8, 0x00, 0x06, 0xb9, 0x00, 0x00, 0xba,
	0x4f, 0x17, 0xb7, 0x00, 0xcd, 0x10, 0xb4, 0x13,
	0xb0, 0x01, 0xb7, 0x00, 0xb3, 0x07, 0xb6, 0x00,
	0xb2, 0x00, 0xbd, 0x9c, 0x7c, 0xb9, 0x44, 0x00,
	0xcd, 0x10, 0xb4, 0x00, 0xcd, 0x16, 0x66, 0xb8,
	0x34, 0x12, 0x00, 0x00, 0x66, 0xa3, 0x72, 0x04,
	0xea, 0x00, 0x00, 0xff, 0xff, 0xeb, 0xfe, 0x00,
	0x00, 0x00, 0x4e, 0x6f, 0x6e, 0x2d, 0x73, 0x79,
	0x73, 0x74, 0x65, 0x6d, 0x20, 0x64, 0x69, 0x73,
	0x6b, 0x20, 0x6f, 0x72, 0x20, 0x64, 0x69, 0x73,
	0x6b, 0x20, 0x65, 0x72, 0x72, 0x6f, 0x72, 0x2e,
	0x20, 0x52, 0x65, 0x70, 0x6c, 0x61, 0x63, 0x65,
	0x20, 0x61, 0x6e, 0x64, 0x20, 0x70, 0x72, 0x65,
	0x73, 0x73, 0x20, 0x61, 0x6e, 0x79, 0x20, 0x6b,
	0x65, 0x79, 0x20, 0x77, 0x68, 0x65, 0x6e, 0x20,
	0x72, 0x65, 0x61, 0x64, 0x79, 0x2e
};




/*
 *
 */
 

uint8 fat16_bootcode[] = 
{
	0x00, 0x00, 0xb8, 0x00, 0x00, 0x8e, 0xd8, 0x8e,
	0xc0, 0xb8, 0x00, 0x06, 0xb9, 0x00, 0x00, 0xba,
	0x4f, 0x17, 0xb7, 0x00, 0xcd, 0x10, 0xb4, 0x13,
	0xb0, 0x01, 0xb7, 0x00, 0xb3, 0x07, 0xb6, 0x00,
	0xb2, 0x00, 0xbd, 0x80, 0x7c, 0xb9, 0x44, 0x00,
	0xcd, 0x10, 0xb4, 0x00, 0xcd, 0x16, 0x66, 0xb8,
	0x34, 0x12, 0x00, 0x00, 0x66, 0xa3, 0x72, 0x04,
	0xea, 0x00, 0x00, 0xff, 0xff, 0xeb, 0xfe, 0x00,
	0x00, 0x00, 0x4e, 0x6f, 0x6e, 0x2d, 0x73, 0x79,
	0x73, 0x74, 0x65, 0x6d, 0x20, 0x64, 0x69, 0x73,
	0x6b, 0x20, 0x6f, 0x72, 0x20, 0x64, 0x69, 0x73,
	0x6b, 0x20, 0x65, 0x72, 0x72, 0x6f, 0x72, 0x2e,
	0x20, 0x52, 0x65, 0x70, 0x6c, 0x61, 0x63, 0x65,
	0x20, 0x61, 0x6e, 0x64, 0x20, 0x70, 0x72, 0x65,
	0x73, 0x73, 0x20, 0x61, 0x6e, 0x79, 0x20, 0x6b,
	0x65, 0x79, 0x20, 0x77, 0x68, 0x65, 0x6e, 0x20,
	0x72, 0x65, 0x61, 0x64, 0x79, 0x2e
};

