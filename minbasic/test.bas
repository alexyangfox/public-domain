  100  REM
  110  REM ---------------------------------
  120  REM ::::: MINBASIC TEST PROGRAM :::::
  130  REM ---------------------------------
  140  REM
  150  IF 1 = 0 STOP
  160  OPEN #3, 'TEST.DAT' : IOCTL #3, 'TRUNCATE'

  170  REM
  180  REM ::::: LET :::::
  190  REM
  200  LET A = 0, A$ = 'FOO', Y(9) = -123, Z$ = 'BAR'
  210  IF A <> 0 STOP
  220  IF A$ <> 'FOO' STOP
  230  IF Y(9) <> -123 STOP
  240  IF Z$ <> 'BAR' STOP

  250  REM
  260  REM ::::: DIM, CLEAR :::::
  270  REM
  280  CLEAR
  290  LET F = FRE(0)
  300  DIM Z(1000)
  310  IF F < FRE(0) STOP
  320  FOR I = 0 TO 999
  330    LET Z(I) = I
  340    IF Z(I) <> I STOP
  350    IF A(I + 250) <> I STOP
  360  NEXT
  370  PRINT #3 : PRINT F : PRINT #1
  380  CLEAR
  390  IOCTL #3, 'REWIND'
  400  INPUT #3 : INPUT F : INPUT #0
  410  IF F <> FRE(0) STOP

  420  REM
  430  REM ::::: IF/THEN/ELSE/ENDIF :::::
  440  REM
  450  IF 1 = 1 REM ALRIGHT
  460  IF 0 = 1 STOP
  470  IF 1 = 1 THEN
  480    IF 1 = 1 THEN
  490      REM OK
  500    ELSE
  510      CLOSE #3
  520      STOP
  530    ENDIF
  540  ELSE
  550    IF 1 = 1 THEN
  560      STOP
  570    ELSE
  580      STOP
  590    ENDIF
  600  ENDIF
  610  IF 1 = 1 THEN
  620    IF 1 = 0 THEN
  630      STOP
  640    ELSE
  650      REM OK
  660    ENDIF
  670  ELSE
  680    IF 1 = 1 THEN
  690      STOP
  700    ELSE
  710      STOP
  720    ENDIF
  730  ENDIF
  740  IF 1 = 0 THEN
  750    IF 1 = 1 THEN
  760      STOP
  770    ELSE
  780      STOP
  790    ENDIF
  800  ELSE
  810    IF 1 = 1 THEN
  820      REM OK
  830    ELSE
  840      STOP
  850    ENDIF
  860  ENDIF
  870  IF 1 = 0 THEN
  880    IF 1 = 1 THEN
  890      STOP
  900    ELSE
  910      STOP
  920    ENDIF
  930  ELSE
  940    IF 1 = 0 THEN
  950      STOP
  960    ELSE
  970      REM OK
  980    ENDIF
  990  ENDIF
 1000  IF 1 = 1 THEN
 1010    IF 1 = 1 THEN
 1020      REM OK
 1030    ENDIF
 1040  ENDIF
 1050  IF 0 = 1 THEN
 1060    IF 1 = 1 THEN
 1070      STOP
 1080    ENDIF
 1090  ENDIF
 1100  IF 1 = 1 THEN
 1110    IF 0 = 1 THEN
 1120      STOP
 1130    ENDIF
 1140  ENDIF
 1150  IF 0 = 1 THEN
 1160    IF 0 = 1 THEN
 1170      STOP
 1180    ENDIF
 1190  ENDIF
 1200  IF 0 = 1 THEN
 1210    STOP
 1220  ELSE
 1230    IF 1 = 1 REM OK
 1240  ENDIF
 1250  IF 1 = 1 THEN
 1260    IF 1 = 1 REM OK
 1270  ELSE
 1280    STOP
 1290  ENDIF

 1300  REM
 1310  REM ::::: FOR/TO/STEP/NEXT :::::
 1320  REM
 1330  LET J = 0
 1340  FOR I = 1 TO 100
 1350    LET J = J + 1
 1360  NEXT
 1370  IF J <> 100 STOP
 1380  LET J = 0
 1390  FOR I = 1 TO 100 STEP 10
 1400    LET J = J + 1
 1410  NEXT
 1420  IF J <> 10 STOP
 1430  LET J = 0
 1440  FOR I = 10 TO 1 STEP -1
 1450    LET J = J + 1
 1460  NEXT
 1470  IF J <> 10 STOP
 1480  LET J = 0
 1490  FOR I = -100 TO 100 STEP 2
 1500    LET J = J + 1
 1510  NEXT
 1520  IF J <> 101 STOP
 1530  LET J = 0
 1540  FOR I = 100 TO -100 STEP -2
 1550    LET J = J + 1
 1560  NEXT
 1570  IF J <> 101 STOP
 1580  LET J = 0
 1590  FOR I = 0 TO -100
 1600    LET J = J + 1
 1610  NEXT
 1620  IF J <> 1 STOP
 1630  LET J = 0
 1640  FOR I = 0 TO 10 STEP -1
 1650    LET J = J + 1
 1660  NEXT
 1670  IF J <> 1 STOP
 1680  LET N = 0
 1690  FOR I = 1 TO 10
 1700    FOR J = 1 TO 10
 1710      FOR K = 1 TO 10
 1720        LET N = N + 1
 1730      NEXT
 1740    NEXT
 1750  NEXT
 1760  IF N <> 1000 STOP

 1770  REM
 1780  REM ::::: GOSUB/WITH/RETURN :::::
 1790  REM
 1800  LET X = 0
 1810  GOSUB 1830
 1820  GOTO 1840
 1830  LET X = 1 : RETURN
 1840  IF X <> 1 STOP
 1850  LET N = 0
 1860  GOSUB 1880
 1870  GOTO 1920
 1880  IF N >= 10 RETURN
 1890  LET N = N + 1
 1900  GOSUB 1880
 1910  RETURN
 1920  IF N <> 10 STOP
 1930  LET X = 123, Y = 0
 1940  GOSUB 1960 WITH X = 456
 1950  GOTO 1970
 1960  LET Y = X : RETURN
 1970  IF X <> 123 STOP
 1980  IF Y <> 456 STOP
 1990  LET X = 42, Y = 999, A$ = 'HELLO, WORLD!'
 2000  GOSUB 2050 WITH X = 17, Y = 555, A$ = 'GOODBYE!'
 2010  IF X <> 42 STOP
 2020  IF Y <> 999 STOP
 2030  IF A$ <> 'HELLO, WORLD!' STOP
 2040  GOTO 2100
 2050  IF X <> 17 STOP
 2060  IF Y <> 555 STOP
 2070  IF A$ <> 'GOODBYE!' STOP
 2080  LET X = 123, Y = 456, A$ = 'SOMETHING ELSE'
 2090  RETURN
 2100  GOSUB 2150 WITH X, Y, A$
 2110  IF X <> 42 STOP
 2120  IF Y <> 999 STOP
 2130  IF A$ <> 'HELLO, WORLD!' STOP
 2140  GOTO 2200
 2150  IF X <> 42 STOP
 2160  IF Y <> 999 STOP
 2170  IF A$ <> 'HELLO, WORLD!' STOP
 2180  LET X = 123, Y = 456, A$ = 'SOMETHING ELSE'
 2190  RETURN

 2200  REM
 2210  REM ::::: GOTO :::::
 2220  REM
 2230  LET C = 0
 2240  LET C = C + 1 : GOTO 2290
 2250  LET C = C + 2 : GOTO 2280
 2260  LET C = C + 3 : GOTO 2270
 2270  LET C = C + 4 : GOTO 2250
 2280  LET C = C + 5 : GOTO 2300
 2290  LET C = C + 6 : GOTO 2260
 2300  IF C <> 21 STOP
 2310  LET C = 0
 2320  FOR I = 0 TO 11
 2330    ON I GOTO 2380, 2390, 2400, 2410, 2420
 2340    ON I - 5 GOTO 2430, 2440, 2450, 2460, 2470
 2350  NEXT
 2360  IF C <> 55 STOP
 2370  GOTO 2480
 2380  LET C = C + 1 : GOTO 2350
 2390  LET C = C + 2 : GOTO 2350
 2400  LET C = C + 3 : GOTO 2350
 2410  LET C = C + 4 : GOTO 2350
 2420  LET C = C + 5 : GOTO 2350
 2430  LET C = C + 6 : GOTO 2350
 2440  LET C = C + 7 : GOTO 2350
 2450  LET C = C + 8 : GOTO 2350
 2460  LET C = C + 9 : GOTO 2350
 2470  LET C = C + 10 : GOTO 2350

 2480  REM
 2490  REM ::::: WHILE/WEND :::::
 2500  REM
 2510  LET X = 0
 2520  WHILE X < 100
 2530    LET X = X + 1
 2540  WEND
 2550  IF X <> 100 STOP
 2560  LET X = 0, Z = 0
 2570  WHILE X < 10
 2580    LET X = X + 1, Y = 0
 2590    WHILE Y < 10
 2600      LET Y = Y + 1, Z = Z + 1
 2610    WEND
 2620  WEND
 2630  IF Z <> 100 STOP

 2640  REM
 2650  REM ::::: REPEAT/UNTIL :::::
 2660  REM
 2670  LET X = 0
 2680  REPEAT
 2690    LET X = X + 1
 2700  UNTIL X >= 100
 2710  IF X <> 100 STOP
 2720  LET X = 0, K = 0
 2730  REPEAT
 2740    LET Y = 0
 2750    REPEAT
 2760      LET Y = Y + 1, K = K + 1
 2770    UNTIL Y >= 10
 2780    LET X = X + 1
 2790  UNTIL X >= 10
 2800  IF K <> 100 STOP

 2810  REM
 2820  REM ::::: EXPRESSIONS :::::
 2830  REM
 2840  IF 123 <> 123 STOP
 2850  IF -123 <> 0 - 123 STOP
 2860  IF -123 <> 0 - 123 STOP
 2870  LET X = 456 : IF X <> 456 STOP
 2880  LET X(0) = 456 : IF X <> 456 STOP
 2890  LET X(1) = 789 : IF X1 <> 789 STOP
 2900  LET X(2) = 12 : IF X2 <> 12 STOP
 2910  LET X(3) = 345 : IF X3 <> 345 STOP
 2920  LET X(4) = 678 : IF X4 <> 678 STOP
 2930  LET X(5) = 910 : IF X5 <> 910 STOP
 2940  LET X(6) = 123 : IF X6 <> 123 STOP
 2950  LET X(7) = 456 : IF X7 <> 456 STOP
 2960  LET X(8) = 789 : IF X8 <> 789 STOP
 2970  LET X(9) = 12 : IF X9 <> 12 STOP
 2980  LET X(10) = 345 : IF Y <> 345 STOP
 2990  IF 3 + 4 <> 7 STOP
 3000  IF 3 * 4 <> 12 STOP
 3010  IF 7 - 5 <> 2 STOP
 3020  IF 16 / 4 <> 4 STOP
 3030  IF 17 / 4 <> 4 STOP
 3040  IF 18 / 4 <> 4 STOP
 3050  IF 19 / 4 <> 4 STOP
 3060  IF 20 / 4 <> 5 STOP
 3070  IF 3 + 4 * 5 <> 23 STOP
 3080  IF (3 + 4) * 5 <> 35 STOP
 3090  IF 3 - 4 * 5 <> -17 STOP
 3100  IF (3 - 4) * 5 <> -5 STOP
 3110  IF 10 + 20 / 3 <> 16 STOP
 3120  IF (10 + 20) / 3 <> 10 STOP
 3130  IF 10 - 20 / 3 <> 4 STOP
 3140  IF (10 - 20) / 3 <> -3 STOP
 3150  IF 11 < 10 STOP
 3160  IF 10 > 11 STOP
 3170  IF 11 <= 10 STOP
 3180  IF 10 >= 11 STOP
 3190  IF 10 <> 10 STOP
 3200  IF 10 = 11 STOP
 3210  IF (NOT 1) <> 0 STOP
 3220  IF (NOT 0) <> 1 STOP
 3230  IF NOT 1 = 1 STOP
 3240  IF NOT 1 <> 0 STOP
 3250  IF NOT 10 < 11 STOP
 3260  IF NOT 11 > 10 STOP
 3270  IF NOT 10 <= 11 STOP
 3280  IF NOT 11 >= 10 STOP
 3290  IF NOT 10 <= 10 STOP
 3300  IF NOT 10 >= 10 STOP
 3310  IF NOT (1 OR 1) STOP
 3320  IF NOT (1 OR 0) STOP
 3330  IF NOT (0 OR 1) STOP
 3340  IF 0 OR 0 STOP
 3350  IF NOT (1 AND 1) STOP
 3360  IF 1 AND 0 STOP
 3370  IF 0 AND 1 STOP
 3380  IF 0 AND 0 STOP
 3390  IF NOT (1 OR 0 AND 0) STOP
 3400  IF (1 OR 0) AND 0 STOP
 3410  IF NOT 1 OR NOT 1 STOP
 3420  IF NOT (NOT 1 OR NOT 0) STOP
 3430  IF NOT (NOT 0 OR NOT 1) STOP
 3440  IF NOT (NOT 0 OR NOT 0) STOP
 3450  IF NOT 1 AND NOT 1 STOP
 3460  IF NOT 1 AND NOT 0 STOP
 3470  IF NOT 0 AND NOT 1 STOP
 3480  IF NOT (NOT 0 AND NOT 0) STOP
 3490  IF NOT 1 + 1 = 1 + 1 STOP
 3500  IF NOT 1 - 1 = 1 - 1 STOP
 3510  IF NOT 2 * 3 = 2 * 3 STOP
 3520  IF NOT 7 / 2 = 7 / 2 STOP
 3530  IF NOT (1 < 1 + 1 AND 2 > 1 - 1) STOP
 3540  IF NOT (1 < 1 + 1 OR 0) STOP
 3550  IF NOT (0 OR 2 > 1 - 1) STOP

 3560  REM
 3570  REM ::::: FUNCTIONS :::::
 3580  REM
 3590  IF ABS(123) <> 123 STOP
 3600  IF ABS(0) <> 0 STOP
 3610  IF ABS(-456) <> 456 STOP
 3620  IF ASC('A') <> 65 STOP
 3630  IF ASC('9') <> 57 STOP
 3640  IF ASC('~') <> 126 STOP
 3650  IF LEN('') <> 0 STOP
 3660  IF LEN('ABC') <> 3 STOP
 3670  IF LEN('0123456789012345678912') <> 22 STOP
 3680  IF '' <> '' STOP
 3690  IF 'ABC' <> 'ABC' STOP
 3700  IF 'ABC' = 'DEF' STOP
 3710  IF 'ABC' = 'AB' STOP
 3720  IF 'AB' = 'ABC' STOP
 3730  IF '' = 'ABC' STOP
 3740  IF 'ABC' = '' STOP
 3750  IF 'ABC' > 'ABC' STOP
 3760  IF 'ABC' > 'ABZ' STOP
 3770  IF 'ABC' > 'ABCD' STOP
 3780  IF 'AZA' > 'ZZZ' STOP
 3790  IF 'ABZ' <= 'ABC' STOP
 3800  IF 'ABCD' <= 'ABC' STOP
 3810  IF 'AZA' <= 'AAA' STOP
 3820  IF 'ABC' < 'ABC' STOP
 3830  IF 'ABZ' < 'ABC' STOP
 3840  IF 'ABCD' < 'ABC' STOP
 3850  IF 'ZZZ' < 'AZA' STOP
 3860  IF 'ABC' >= 'ABZ' STOP
 3870  IF 'ABC' >= 'ABCD' STOP
 3880  IF 'AAA' >= 'AZA' STOP
 3890  IF POS('F', 'FROB') <> 1 STOP
 3900  IF POS('R', 'FROB') <> 2 STOP
 3910  IF POS('O', 'FROB') <> 3 STOP
 3920  IF POS('B', 'FROB') <> 4 STOP
 3930  IF POS('X', 'FROB') <> 0 STOP
 3940  IF POS('FOO', 'FOO') <> 1 STOP
 3950  IF POS('BAR', 'FOOBARBAZBAR') <> 4 STOP
 3960  IF POS('FOO', 'FOFOFOFOFO') <> 0 STOP
 3970  FOR I = 1 TO 1000 STEP 100
 3980    IF RND(I) < 0 OR RND(I) >= I STOP
 3990  NEXT
 4000  IF VAL('0') <> 0 STOP
 4010  IF VAL('1') <> 1 STOP
 4020  IF VAL('-1') <> -1 STOP
 4030  IF VAL('12345') <> 12345 STOP
 4040  IF VAL('6789') <> 6789 STOP
 4050  IF VAL('     -6789') <> -6789 STOP
 4060  IF VAL(' -123TRAILING') <> -123 STOP

 4070  REM
 4080  REM ::::: STRING EXPRESSIONS :::::
 4090  REM
 4100  LET A$ = 'FOO' : IF A$ <> 'FOO' STOP
 4110  LET A$(0) = 'ABC' : IF A$ <> 'ABC' STOP
 4120  LET A$(1) = 'DEF' : IF B$ <> 'DEF' STOP
 4130  LET A$(2) = 'GHI' : IF C$ <> 'GHI' STOP
 4140  LET A$(3) = 'JKL' : IF D$ <> 'JKL' STOP
 4150  LET A$(4) = 'MNO' : IF E$ <> 'MNO' STOP
 4160  LET A$(5) = 'PQR' : IF F$ <> 'PQR' STOP
 4170  LET A$(6) = 'STU' : IF G$ <> 'STU' STOP
 4180  LET A$(7) = 'VWX' : IF H$ <> 'VWX' STOP
 4190  LET A$(8) = 'YZA' : IF I$ <> 'YZA' STOP
 4200  LET A$(9) = 'BCD' : IF J$ <> 'BCD' STOP
 4210  LET A$(124) = 'ZZZ' : IF Z$(99) <> 'ZZZ' STOP
 4220  IF 'ABC' + 'DEF' <> 'ABCDEF' STOP
 4230  IF 'ABC' + '' <> 'ABC' STOP
 4240  IF '' + 'DEF' <> 'DEF' STOP
 4250  IF 'H' + 'E' + 'L' + 'L' + 'O' <> 'HELLO' STOP

 4260  REM
 4270  REM ::::: STRING FUNCTIONS :::::
 4280  REM
 4290  IF CHR$(65) <> 'A' STOP
 4300  IF CHR$(57) <> '9' STOP
 4310  IF CHR$(126) <> '~' STOP
 4320  IF STR$(0) <> '0' STOP
 4330  IF STR$(1) <> '1' STOP
 4340  IF STR$(12345) <> '12345' STOP
 4350  IF STR$(6789) <> '6789' STOP
 4360  IF STR$(-1) <> '-1' STOP
 4370  IF STR$(-12345) <> '-12345' STOP
 4380  IF MID$('FOOBAR', 1) <> 'FOOBAR' STOP
 4390  IF MID$('FOOBAR', 2) <> 'OOBAR' STOP
 4400  IF MID$('FOOBAR', 4) <> 'BAR' STOP
 4410  IF MID$('FOOBAR', 6) <> 'R' STOP
 4420  IF MID$('FOOBAR', 7) <> '' STOP
 4430  IF MID$('FOOBAR', 999) <> '' STOP
 4440  IF MID$('FOOBAR', 0) <> 'FOOBAR' STOP
 4450  IF MID$('FOOBAR', 1, 1) <> 'F' STOP
 4460  IF MID$('FOOBAR', 3, 1) <> 'O' STOP
 4470  IF MID$('FOOBAR', 6, 1) <> 'R' STOP
 4480  IF MID$('FOOBAR', 1, 3) <> 'FOO' STOP
 4490  IF MID$('FOOBAR', 4, 3) <> 'BAR' STOP
 4500  IF MID$('FOOBAR', 4, 999) <> 'BAR' STOP
 4510  IF MID$('FOOBAR', 0, 0) <> '' STOP
 4520  IF MID$('FOOBAR', 999, 999) <> '' STOP

 4530  REM
 4540  REM ::::: USER-DEFINED FUNCTIONS :::::
 4550  REM
 4560  DEF F%(X) = X - X / 3 * 3 = 0
 4570  IF NOT F%(0) STOP
 4580  IF F%(1) STOP
 4590  IF F%(2) STOP
 4600  IF NOT F%(3) STOP
 4610  IF F%(4) STOP
 4620  IF F%(5) STOP
 4630  IF NOT F%(6) STOP
 4640  IF F%(7) STOP
 4650  DEF I%(X) = X
 4660  LET X = 123
 4670  IF I%(456) <> 456 STOP
 4680  IF X <> 123 STOP
 4690  DEF A%(X) = B%(X) * X
 4700  DEF B%(Y) = C%(Y) * Y
 4710  DEF C%(Z) = Z
 4720  LET X = 123, Y = 456, Z = 789
 4730  IF A%(5) <> 125 STOP
 4740  IF B%(5) <> 25 STOP
 4750  IF C%(5) <> 5 STOP
 4760  IF X <> 123 STOP
 4770  IF Y <> 456 STOP
 4780  IF Z <> 789 STOP
 4790  DEF T%(X) = X + X
 4800  IF T%(5) <> 10 STOP
 4810  IF T%(T%(5)) <> 20 STOP
 4820  IF T%(T%(T%(5))) <> 40 STOP
 4830  GOTO 4850
 4840  LET X = X + 1 : RETURN Q + 1
 4850  DEF P%(Q) = CALL(4840)
 4860  LET X = 0 : IF P%(5) <> 6 OR X <> 1 STOP
 4870  LET X = 0 : IF P%(P%(-1)) <> 1 OR X <> 2 STOP
 4880  LET X = 0 : IF P%(P%(P%(1))) <> 4 OR X <> 3 STOP

 4890  REM
 4900  REM ::::: INPUT/OUTPUT :::::
 4910  REM
 4920  OPEN #3, 'TEST.DAT'
 4930  PRINT #3
 4940  FOR I = 1 TO 100
 4950    PRINT I
 4960  NEXT
 4970  PRINT #1 : CLOSE #3
 4980  OPEN #3, 'TEST.DAT'
 4990  INPUT #3
 5000  FOR I = 1 TO 100
 5010    INPUT X : IF I <> X STOP
 5020  NEXT
 5030  INPUT #0 : CLOSE #3
 5040  OPEN #3, 'TEST.DAT' : INPUT #3
 5050  FOR I = 1 TO 50
 5060    INPUT X
 5070  NEXT
 5080  IOCTL #3, 'TRUNCATE'
 5090  CLOSE #3
 5100  OPEN #3, 'TEST.DAT'
 5110  GOSUB 6860 : REM READ FILE
 5120  IF N <> 50 STOP
 5130  IOCTL #3, 'REWIND'
 5140  GOSUB 6860 : REM READ FILE
 5150  IF N <> 50 STOP
 5160  CLOSE #3
 5170  OPEN #3, 'TEST.DAT'
 5180  IOCTL #3, 'APPEND'
 5190  PRINT #3 : PRINT -123 : PRINT #1
 5200  IOCTL #3, 'REWIND'
 5210  GOSUB 6860 : REM READ FILE
 5220  IF N <> -123 STOP
 5230  CLOSE #3

 5240  REM
 5250  REM ::::: READ/DATA/RESTORE :::::
 5260  REM
 5270  DATA 1, 'NOTHING TO HAVE'
 5280  DATA 1, 'NOTHING TO DO'
 5290  DATA 1, 'NOTHING TO BECOME'
 5300  DATA 0
 5310  READ X
 5320  WHILE X
 5330    READ A$, X
 5340  WEND
 5350  RESTORE
 5360  READ X
 5370  WHILE X
 5380    READ A$, X
 5390  WEND
 5400  DATA 'FOO', '''BAR'''
 5410  DATA 'BAZ'
 5420  READ A$, B$, C$
 5430  IF A$ <> 'FOO' STOP
 5440  IF B$ <> '''BAR''' STOP
 5450  IF C$ <> 'BAZ' STOP
 5460  DATA 456, 123, -789
 5470  READ X, Y, Z
 5480  IF X <> 456 STOP
 5490  IF Y <> 123 STOP
 5500  IF Z <> -789 STOP
 5510  RESTORE 5410
 5520  READ A$ : IF A$ <> 'BAZ' STOP

 5530  REM
 5540  REM ::::: CALL( OPERATOR :::::
 5550  REM
 5560  GOTO 5630

 5570  REM *** ITERATIVE TEST FUNCTION ***
 5580  LET R = 1
 5590  FOR I = 1 TO X
 5600    LET R = R * I
 5610  NEXT
 5620  RETURN R
 5630  IF CALL(5580 WITH X = 0) <> 1 STOP
 5640  IF CALL(5580 WITH X = 3) <> 6 STOP
 5650  IF CALL(5580 WITH X = 6) <> 720 STOP
 5660  LET X = 5 : IF CALL(5580 WITH X) <> 120 STOP
 5670  GOTO 5710

 5680  REM *** RECURSIVE TEST FUNCTION ***
 5690  IF X = 0 RETURN 1
 5700  RETURN CALL(5690 WITH X = X - 1) * X
 5710  IF CALL(5690 WITH X = 0) <> 1 STOP
 5720  IF CALL(5690 WITH X = 3) <> 6 STOP
 5730  IF CALL(5690 WITH X = 6) <> 720 STOP
 5740  LET X = 5 : IF CALL(5690 WITH X) <> 120 STOP

 5750  REM
 5760  REM ::::: LOCAL / ENDLOC :::::
 5770  REM
 5780  LET C = 0
 5790  FOR I = 1 TO 10
 5800    LOCAL I
 5810      FOR I = 1 TO 10
 5820        LET C = C + 1
 5830      NEXT
 5840    ENDLOC
 5850  NEXT
 5860  IF C <> 100 STOP
 5870  LET N = 123, M = 789, X$ = 'TEST DATA'
 5880  LOCAL N
 5890  LOCAL M = -321, X$ = 'FOO'
 5900    IF N <> 123 STOP
 5910    IF M <> -321 STOP
 5920    IF X$ <> 'FOO' STOP
 5930    LET N = 555, M = 777, X$ = 'FOOBAR'
 5940  ENDLOC
 5950  IF N <> 123 STOP
 5960  IF M <> 789 STOP
 5970  IF X$ <> 'TEST DATA' STOP

 5980  REM
 5990  REM ::::: LOCAL/RETURN :::::
 6000  REM
 6010  GOTO 6070
 6020  LOCAL I, R = 1
 6030    FOR I = 1 TO X
 6040      LET R = R * I
 6050    NEXT
 6060  RETURN R
 6070  LET R = -123
 6080  IF CALL(6020 WITH X = 5) <> 120 STOP
 6090  IF CALL(6020 WITH X = 1) <> 1 STOP
 6100  IF R <> -123 STOP

 6110  REM
 6120  REM ::::: LABEL AND SYMBOLIC ADDRESSES :::::
 6130  REM
 6140  LET C = 0
 6150  LET C = C + 1 : GOTO &G.1

 6160  LABEL &G.3
 6170  LET C = C + 2 : GOTO &G.2

 6180  LABEL &G.1
 6190  LET C = C + 3 : GOTO &G.3

 6200  LABEL &G.2
 6210  IF C <> 6 STOP
 6220  GOTO &TEST.1

 6230  LABEL &INC
 6240  LET X = X + 1
 6250  RETURN X

 6260  LABEL &TEST.1
 6270  IF CALL(&INC WITH X = 1) <> 2 STOP
 6280  IF CALL(&INC WITH X = 2) <> 3 STOP
 6290  LET X = 5
 6300  GOSUB &INC : GOSUB &INC
 6310  IF X <> 7 STOP
 6320  LET X = 0
 6330  FOR I = 0 TO 4
 6340    ON I GOTO &FOO.1, &FOO.2, &FOO.3
 6350    LABEL &BACK
 6360  NEXT
 6370  GOTO &TEST.2

 6380  LABEL &FOO.1
 6390  LET X = X + 1 : GOTO &BACK

 6400  LABEL &FOO.2
 6410  LET X = X + 2 : GOTO &BACK

 6420  LABEL &FOO.3
 6430  LET X = X + 3 : GOTO &BACK

 6440  LABEL &TEST.2
 6450  IF X <> 6 STOP

 6460  LABEL &DATA
 6470  DATA 1, 2, 3

 6480  LABEL &MORE.DATA
 6490  DATA 7, 8, 9
 6500  RESTORE &DATA
 6510  READ A, B, C
 6520  IF A <> 1 OR B <> 2 OR C <> 3 STOP
 6530  READ A, B, C
 6540  IF A <> 7 OR B <> 8 OR C <> 9 STOP
 6550  RESTORE &MORE.DATA
 6560  READ A, B, C
 6570  IF A <> 7 OR B <> 8 OR C <> 9 STOP

 6580  REM
 6590  REM ::::: EXIT :::::
 6600  REM
 6610  FOR X = 1 TO 100
 6620    IF X = 10 EXIT
 6630  NEXT
 6640  IF X <> 10 STOP
 6650  LET X = 0
 6660  WHILE X < 100
 6670    LET X = X + 1
 6680    IF X = 20 EXIT
 6690  WEND
 6700  IF X <> 20 STOP
 6710  LET X = 0
 6720  REPEAT
 6730    LET X = X + 1
 6740    IF X = 30 EXIT
 6750  UNTIL X >= 100
 6760  IF X <> 30 STOP

 6770  REM
 6780  REM ::::: END OF TEST PROGRAM :::::
 6790  REM
 6800  ERASE 'TEST.DAT'
 6810  PRINT 'PASSED'
 6820  END

 6830  REM
 6840  REM ::::: SUBROUTINE : READ TEST FILE FROM #3 :::::
 6850  REM
 6860  INPUT #3 : INPUT X
 6870  WHILE NOT EOF(0)
 6880    LET N = X
 6890    INPUT X
 6900  WEND
 6910  RETURN
